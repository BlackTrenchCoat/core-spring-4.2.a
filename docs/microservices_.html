<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;14.&nbsp;spring-microservices - Microservices with Spring</title><link rel="stylesheet" href="css/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.70.0"><link rel="start" href="index.html" title="Core Spring - Lab Documentation"><link rel="up" href="index.html" title="Core Spring - Lab Documentation"><link rel="prev" href="rest-ws-lab.html" title="Chapter&nbsp;13.&nbsp;rest-ws: Building RESTful applications with Spring MVC"><link rel="next" href="xml-dependency-best-practices.html" title="Chapter&nbsp;15.&nbsp;xml-dependency-best-practices: XML Dependency Injection Best Practices"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div xmlns="http://www.w3.org/TR/xhtml1/transitional" style="background-color:white;border:none;height:73px;border:1px solid black;"><a style="border:none;" href="http://www.pivotal.io" title="Pivotal"><img style="border:none;" src="images/heading-logo-lhs.jpg"></img></a><a style="border:none;" href="http://www.spring.io" title="The Spring Framework"><img style="border:none;position:absolute;padding-top:5px;right:42px;" src="images/heading-logo-rhs.jpg"></img></a></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h1 class="title"><a name="microservices_"></a>spring-microservices - Microservices with Spring</h1></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="microservices__introduction"></a>14.1.&nbsp;Introduction</h2></div></div></div><p>This lab refactor the MVC application to use a microservice.</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="microservices__what_you_will_learn"></a>14.1.1.&nbsp;What you will learn:</h3></div></div></div><div class="orderedlist"><ol type="1"><li>How to deploy a Eureka service-discovery server</li><li>How to write a microservice with a RESTful interface</li><li>How to access a microservice and interact with it.</li></ol></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="microservices__specific_subjects_you_will_gain_experience_with"></a>14.1.2.&nbsp;Specific subjects you will gain experience with:</h3></div></div></div><div class="orderedlist"><ol type="1"><li>Spring Cloud projects</li><li>Eureka discovery-server</li><li>Using @DiscoveryClient</li><li>Spring Clouds enhanced <code class="literal">RestTemplate</code>
                    </li></ol></div><p>Estimated time to complete: 45 minutes</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="microservices__overview"></a>14.1.3.&nbsp;Overview</h3></div></div></div><p>The original application was a simple, single process "monolith".  It managed its own
accounts database and fetched data directly.</p><p>We are going to refactor it into two processes:</p><p>
                <span class="inlinemediaobject"><img src="images/architecture.png" alt="Component Model"></span>
            </p><p>The full system requires a discovery-server, making three processes in all:</p><p>
                <span class="inlinemediaobject"><img src="images/mini-system.png" alt="System Architecture"></span>
            </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="microservices__notes"></a>14.1.4.&nbsp;Notes</h3></div></div></div><p>Since you will be running (eventually) 3 applications at the same time:</p><div class="orderedlist"><ol type="1"><li>You will need to switch between console output (use the Display Selected Console icon
on the right-hand side of the Console view.</li><li>Output to the console will keep taking the focus from the Task window.  To avoid this,
drag the Console view so it sits in its own pane.  Ask your instructor if you don&#8217;t
know how to do this.</li></ol></div><p>
                <span class="inlinemediaobject"><img src="images/console.png" alt="Console View"></span>
            </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="microservices__instructions"></a>14.1.5.&nbsp;Instructions</h3></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="microservices__discovery_server"></a>14.1.5.1.&nbsp;Discovery Server</h4></div></div></div><div class="orderedlist"><ol type="1"><li><p>Write the Discovery Server.  <code class="literal">RegistrationServer.java</code> is the only file you need.
Follow TODOs 01-03 to make it into a Eureka Discovery Server running as a Spring
Boot application.</p><div class="itemizedlist"><ul type="disc"><li>Hint: Set <code class="literal">spring.config.name</code> system property to define the YAML file it should use for configuration (refer back to the Spring Boot notes in your handout).</li></ul></div></li><li>TODO-04: Run the <code class="literal">RegistrationServer</code> as a Spring Boot app and go to
<a href="http://localhost:1111" target="_top">http://localhost:1111</a> to view its Dashboard.</li><li>TODO-05: Quiz: where is the port 1111 configured?</li></ol></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="microservices__accounts_microservice"></a>14.1.5.2.&nbsp;Accounts Microservice</h4></div></div></div><div class="orderedlist"><ol type="1"><li>TODO-06: Setup the <code class="literal">AccountsMicroservice.java</code> to be a Spring Boot application that
registers itself with the Registration Server.</li><li>TODO-07: Run the AccountsMicroservice as a Spring Boot application and go to its
home-page: <a href="http://localhost:/NNNN" target="_top">http://localhost:/NNNN</a> - you will need to work out the port number
it is listening to (how? - similar to TODO-05).  You should be able to fetch an
account list as JSON by clicking the link.</li><li>TODO-08: Go back to the Registration Server dashboard <a href="http://localhost:1111" target="_top">http://localhost:1111</a>.  Has
this microservice registered yet (you may need to wait a minute or so and refresh
the screen a few times).</li></ol></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="microservices__accounts_web_application"></a>14.1.5.3.&nbsp;Accounts Web Application</h4></div></div></div><div class="orderedlist"><ol type="1"><li>TODOs 09-11: Setup <code class="literal">AccountsWebApplication.java</code> as a micro-service client.
Note that TODO-11 is for information, there is nothing to do.</li><li>TODOs 12-14: Setup <code class="literal">RemoteAccountManager</code> to access the Accounts microservice
using RESTful requests - you will need a <code class="literal">RestTemplate</code> to do the work.</li><li>TODO-15: Return to <code class="literal">AccountsWebApplication.java</code> and run it as a Spring Boot
application.  Once it is up and running properly it will also appear in the
Registration Server dashboard - this may take a minute or so.</li><li>TODO-15: Goto <a href="http://localhost:8080" target="_top">http://localhost:8080</a> and see if you can list and view accounts.</li></ol></div><p>Notice that setting up all three processes is a lot more complicated than running our
original MVC application.  But each process is actually very simple.</p><p>Congratulations, you have finished the lab.</p></div></div></div></div><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navfooter"><hr></hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="rest-ws-lab.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="xml-dependency-best-practices.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;13.&nbsp;rest-ws: Building RESTful applications with Spring MVC&nbsp;</td><td width="20%" align="center"><span style="color:white;font-size:90%;"><a href="http://www.spring.io" title="The Spring Framework">Spring By Pivotal</a></span></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;15.&nbsp;xml-dependency-best-practices: XML Dependency Injection Best Practices</td></tr></table></div></body></html>